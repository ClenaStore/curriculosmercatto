<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Banco de Curr√≠culos ‚Ä¢ Grupo DV</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

<style>
:root{
  --bg:#f8fafc;--card:#fff;--text:#0f172a;--muted:#64748b;--line:#e2e8f0;
  --accent:#2563eb;--accent-dark:#1e40af;--radius:14px;
  --shadow:0 6px 16px rgba(15,23,42,.08);
}
*{box-sizing:border-box;font-family:'Inter',sans-serif;}
body{background:var(--bg);margin:0;color:var(--text);}
header{
  background:linear-gradient(135deg,#2563eb,#1e40af);
  color:white;text-align:center;padding:2rem;
  font-size:1.8rem;font-weight:700;box-shadow:var(--shadow);
}
main{
  max-width:700px;margin:2rem auto;background:var(--card);
  padding:2rem;border-radius:var(--radius);box-shadow:var(--shadow);
}
label{display:block;margin-top:1rem;font-weight:600;}
input,select,textarea{
  width:100%;padding:.8rem;margin-top:.3rem;font-size:1rem;
  border:1px solid var(--line);border-radius:var(--radius);
}
input:focus,select:focus,textarea:focus{
  border-color:var(--accent);outline:none;
}
button{
  width:100%;padding:1rem;font-size:1rem;font-weight:600;
  border:none;border-radius:var(--radius);cursor:pointer;margin-top:1rem;
  transition:.2s;
}
#enviar{background:var(--accent);color:white;}
#enviar:hover{background:var(--accent-dark);}
#abrirPopup{background:var(--muted);color:white;}
#abrirPopup:hover{background:#475569;}
#msg{text-align:center;margin-top:1rem;font-weight:600;}

/* Barra de progresso */
.progress-container{margin-top:1rem;background:#e5e7eb;border-radius:10px;height:12px;width:100%;overflow:hidden;}
.progress-bar{height:12px;width:0;background:var(--accent);transition:width .3s;}

/* Modal de cria√ß√£o de curr√≠culo */
#popupOverlay{
  position:fixed;inset:0;background:rgba(0,0,0,.6);
  display:none;align-items:center;justify-content:center;z-index:1000;
}
#popup{
  background:var(--card);border-radius:var(--radius);box-shadow:var(--shadow);
  width:90%;max-width:500px;padding:2rem;position:relative;
}
#popup h3{margin-top:0;text-align:center;}
#popup button.close{
  position:absolute;top:10px;right:15px;background:none;border:none;
  font-size:1.5rem;cursor:pointer;color:var(--muted);
}
</style>
</head>

<body>
<header>üíº Banco de Curr√≠culos ‚Ä¢ Grupo DV</header>

<main>
  <h2>Cadastre seu curr√≠culo</h2>
  <form id="form-cv">
    <label>Nome completo *</label>
    <input type="text" name="nome" required>

    <label>Idade *</label>
    <input type="number" name="idade" required min="16" max="100">

    <label>√Årea de interesse *</label>
    <select name="area" required>
      <option value="">Selecione...</option>
      <option>Atendimento</option>
      <option>Cozinha</option>
      <option>Administra√ß√£o</option>
      <option>Marketing</option>
      <option>Limpeza / Servi√ßos Gerais</option>
    </select>

    <label>Anexar curr√≠culo (PDF, DOC ou DOCX)</label>
    <input type="file" name="arquivo" accept=".pdf,.doc,.docx">

    <div class="progress-container">
      <div class="progress-bar" id="progressBar"></div>
    </div>

    <p style="text-align:center;margin-top:1.2rem;color:var(--muted)">‚Äî ou ‚Äî</p>

    <button type="button" id="abrirPopup">Criar curr√≠culo b√°sico</button>
    <button type="submit" id="enviar">Enviar Curr√≠culo</button>
    <div id="msg"></div>
  </form>
</main>

<!-- Popup cria√ß√£o de curr√≠culo -->
<div id="popupOverlay">
  <div id="popup">
    <button class="close" id="fecharPopup">&times;</button>
    <h3>üìù Criar Curr√≠culo B√°sico</h3>
    <label>Resumo Profissional</label>
    <textarea id="cvResumo" rows="5" placeholder="Fale sobre voc√™..."></textarea>

    <label>Experi√™ncias Profissionais</label>
    <textarea id="cvExperiencias" rows="5" placeholder="Liste seus empregos anteriores..."></textarea>

    <label>Forma√ß√£o e Cursos</label>
    <textarea id="cvFormacao" rows="4" placeholder="Escreva sua forma√ß√£o..."></textarea>

    <button id="gerarPDF">Gerar e baixar PDF</button>
  </div>
</div>

<script>
const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxXG5G7MEUGYc-krms6BwjjpvMNNi9wiflmS_KLyaJNBgceU1C9X5U-srfmqq_GlHHS/exec'; // substitua

// ==== UPLOAD COM BARRA DE PROGRESSO ====
document.getElementById('form-cv').addEventListener('submit', e=>{
  e.preventDefault();
  const form = e.target;
  const data = new FormData(form);
  const msg = document.getElementById('msg');
  const bar = document.getElementById('progressBar');
  msg.textContent = 'Enviando... ‚è≥';
  bar.style.width = '0%';

  const xhr = new XMLHttpRequest();
  xhr.open('POST', SCRIPT_URL);
  xhr.upload.onprogress = evt=>{
    if(evt.lengthComputable){
      const percent = (evt.loaded / evt.total) * 100;
      bar.style.width = percent.toFixed(0) + '%';
    }
  };
  xhr.onload = ()=>{
    if(xhr.status === 200){
      const json = JSON.parse(xhr.responseText);
      if(json.result === 'success'){
        msg.textContent = '‚úÖ Curr√≠culo enviado com sucesso!';
        form.reset();
      } else msg.textContent = '‚ùå Erro ao enviar.';
    } else msg.textContent = '‚ö†Ô∏è Falha na conex√£o.';
  };
  xhr.onerror = ()=> msg.textContent = '‚ö†Ô∏è Erro de rede.';
  xhr.send(data);
});

// ==== POPUP DE CRIA√á√ÉO DE CURR√çCULO ====
const popupOverlay = document.getElementById('popupOverlay');
document.getElementById('abrirPopup').onclick = ()=> popupOverlay.style.display='flex';
document.getElementById('fecharPopup').onclick = ()=> popupOverlay.style.display='none';

// ==== GERA√á√ÉO DE PDF ====
document.getElementById('gerarPDF').addEventListener('click', ()=>{
  const nome = document.querySelector('[name="nome"]').value || 'Sem Nome';
  const idade = document.querySelector('[name="idade"]').value || '‚Äî';
  const area = document.querySelector('[name="area"]').value || '‚Äî';
  const resumo = document.getElementById('cvResumo').value || '';
  const exp = document.getElementById('cvExperiencias').value || '';
  const formacao = document.getElementById('cvFormacao').value || '';

  const modelo = `
    <div style="font-family:Inter,sans-serif;">
      <h2 style="text-align:center;">Curr√≠culo</h2>
      <p><b>Nome:</b> ${nome}</p>
      <p><b>Idade:</b> ${idade}</p>
      <p><b>√Årea de Interesse:</b> ${area}</p>
      <h3>Resumo Profissional</h3>
      <p>${resumo.replace(/\n/g,'<br>')}</p>
      <h3>Experi√™ncias</h3>
      <p>${exp.replace(/\n/g,'<br>')}</p>
      <h3>Forma√ß√£o e Cursos</h3>
      <p>${formacao.replace(/\n/g,'<br>')}</p>
    </div>
  `;

  html2pdf().set({
    margin:10,
    filename:`${nome.replaceAll(' ','_')}_curriculo.pdf`,
    html2canvas:{scale:2},
    jsPDF:{unit:'mm',format:'a4',orientation:'portrait'}
  }).from(modelo).save();

  popupOverlay.style.display='none';
});
</script>
</body>
</html>
