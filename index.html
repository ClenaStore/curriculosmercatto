<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Banco de Curr√≠culos ‚Ä¢ Grupo DV</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

<style>
:root {
  --bg:#0b0f19;--card:#151d2f;--text:#f8fafc;--muted:#94a3b8;
  --line:#243043;--accent:#b8860b;--accent2:#ffd65a;
  --radius:14px;--shadow:0 6px 16px rgba(0,0,0,.35);
}
body{margin:0;background:var(--bg);color:var(--text);font-family:'Inter',sans-serif;}
header{
  background:linear-gradient(135deg,#b8860b,#d4af37);
  color:#fff;text-align:center;padding:2rem 1rem;
  font-size:1.8rem;font-weight:700;box-shadow:var(--shadow);
}
main{
  max-width:700px;margin:2rem auto;background:var(--card);
  padding:2rem;border-radius:var(--radius);box-shadow:var(--shadow);
}
h2{text-align:center;color:var(--accent2);margin-top:0;}
label{display:block;margin-top:1rem;font-weight:600;}
input,select,textarea{
  width:100%;padding:.9rem;margin-top:.3rem;font-size:1rem;
  border:1px solid var(--line);border-radius:var(--radius);
  background:#0f1629;color:var(--text);
}
button{
  width:100%;padding:1rem;margin-top:1.2rem;
  border:none;border-radius:var(--radius);
  font-weight:600;cursor:pointer;font-size:1rem;
  transition:.2s;letter-spacing:.3px;
}
#enviar{background:var(--accent);color:#fff;}
#enviar:hover{background:var(--accent2);color:#000;}
#abrirPopup{background:#2d364b;color:#fff;}
#abrirPopup:hover{background:#384763;}
#msg{text-align:center;margin-top:1rem;font-weight:600;color:var(--accent2);}
.progress-container{margin-top:1.2rem;background:#2d364b;border-radius:10px;height:14px;width:100%;}
.progress-bar{height:14px;width:0;background:linear-gradient(90deg,#b8860b,#ffd65a);transition:width .3s;}
.progress-text{text-align:center;font-size:.9rem;color:var(--muted);margin-top:.4rem;}
#popupOverlay{
  position:fixed;inset:0;background:rgba(0,0,0,.6);
  display:none;align-items:center;justify-content:center;z-index:1000;
}
#popup{
  background:var(--card);border-radius:var(--radius);box-shadow:var(--shadow);
  width:90%;max-width:500px;padding:2rem;position:relative;
}
#popup h3{text-align:center;color:var(--accent2);}
#popup button.close{
  position:absolute;top:10px;right:15px;background:none;border:none;
  font-size:1.6rem;cursor:pointer;color:var(--muted);
}
</style>
</head>

<body>
<header>üíº Banco de Curr√≠culos ‚Ä¢ Grupo DV</header>

<main>
  <h2>Cadastre seu curr√≠culo</h2>
  <form id="form-cv">
    <label>Nome completo *</label>
    <input type="text" name="nome" required>

    <label>Idade *</label>
    <input type="number" name="idade" required min="16" max="100">

    <label>√Årea de interesse *</label>
    <select name="area" required>
      <option value="">Selecione...</option>
      <option>Atendimento</option>
      <option>Cozinha</option>
      <option>Administra√ß√£o</option>
      <option>Marketing</option>
      <option>Limpeza / Servi√ßos Gerais</option>
    </select>

    <label>Anexar curr√≠culo (PDF, DOC ou DOCX)</label>
    <input type="file" id="arquivo" accept=".pdf,.doc,.docx">

    <div class="progress-container">
      <div class="progress-bar" id="progressBar"></div>
    </div>
    <div class="progress-text" id="progressText"></div>

    <p style="text-align:center;margin-top:1.2rem;color:var(--muted)">‚Äî ou ‚Äî</p>

    <button type="button" id="abrirPopup">Criar curr√≠culo b√°sico</button>
    <button type="submit" id="enviar">Enviar Curr√≠culo</button>
    <div id="msg"></div>
  </form>
</main>

<!-- Popup -->
<div id="popupOverlay">
  <div id="popup">
    <button class="close" id="fecharPopup">&times;</button>
    <h3>üìù Criar Curr√≠culo B√°sico</h3>

    <label>Resumo Profissional</label>
    <textarea id="cvResumo" rows="4"></textarea>

    <label>Experi√™ncias Profissionais</label>
    <textarea id="cvExp" rows="4"></textarea>

    <label>Forma√ß√£o e Cursos</label>
    <textarea id="cvForm" rows="3"></textarea>

    <button id="gerarPDF">Gerar e baixar PDF</button>
  </div>
</div>

<script>
const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxH6A-L6A8a9T1fu1W9tbXRMpQFT2gNdciqZRD-cabwlsHXuWeuSXJuVgaS0-epTVgW/exec';

const toBase64 = file => new Promise((resolve,reject)=>{
  const reader = new FileReader();
  reader.readAsDataURL(file);
  reader.onload = ()=>resolve(reader.result.split(',')[1]);
  reader.onerror = error=>reject(error);
});

document.getElementById('form-cv').addEventListener('submit', async e=>{
  e.preventDefault();
  const msg = document.getElementById('msg');
  const bar = document.getElementById('progressBar');
  const txt = document.getElementById('progressText');
  msg.textContent = 'Convertendo arquivo...';
  bar.style.width = '10%';

  const nome = e.target.nome.value.trim();
  const idade = e.target.idade.value.trim();
  const area = e.target.area.value.trim();
  const fileInput = document.getElementById('arquivo');
  const conteudo = '';

  let fileData = '';
  let fileName = '';
  if(fileInput.files.length > 0){
    const file = fileInput.files[0];
    fileData = await toBase64(file);
    fileName = file.name;
  }

  msg.textContent = 'Enviando...';
  bar.style.width = '40%';
  txt.textContent = 'Enviando dados...';

  const body = {
    nome, idade, area, conteudo,
    fileData, fileName
  };

  try{
    const res = await fetch(SCRIPT_URL, {
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body: JSON.stringify(body)
    });
    const json = await res.json();
    if(json.result === 'success'){
      bar.style.width = '100%';
      txt.textContent = 'Conclu√≠do ‚úÖ';
      msg.textContent = 'Curr√≠culo enviado com sucesso!';
      e.target.reset();
    } else {
      msg.textContent = '‚ùå Erro no envio: ' + json.message;
    }
  }catch(err){
    msg.textContent = '‚ö†Ô∏è Erro de rede: ' + err.message;
  }
});
</script>
</body>
</html>
